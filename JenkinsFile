//pipeline{
  // agent any
  node {
   def mvnHome
   stage('Prepare') {
      //git url: 'git@github.com:satyacicd/devops.git', branch: 'master'
      mvnHome = tool 'maven'
   }
stage('Build') {
      if (isUnix()) {
         sh "'${mvnHome}/bin/mvn' -Dmaven.test.failure.ignore clean package"
      } else {
         bat(/"${mvnHome}\bin\mvn" -Dmaven.test.failure.ignore clean package/)
      }
   }
   stage('Integration Test') {
     if (isUnix()) {
        sh "'${mvnHome}/bin/mvn' -Dmaven.test.failure.ignore clean verify"
     } else {
        bat(/"${mvnHome}\bin\mvn" -Dmaven.test.failure.ignore clean verify/)
     }
   }
  stage('Artifacts') {
      if (isUnix()) {
         sh "'${mvnHome}/bin/mvn' -Dmaven.test.failure.ignore clean deploy"
      } else {
         bat(/"${mvnHome}\bin\mvn" -Dmaven.test.failure.ignore clean deploy/)
      }
   }
  stage('Deploy') {
      if (isUnix()) {
		   echo "deploying war from http://localhost:8071/artifactory/libs-snapshot-local/com/example/devops/1.0.1-SNAPSHOT/devops-1.0.1-20181013.182353-40.war"
		   sh 'curl -u admin:redhat@123 -T *.war "http://localhost:8090/manager/text/deploy?path=/devops&update=true"'
      }else{
      //bat('curl -O "http://localhost:8071/artifactory/libs-snapshot-local/com/example/devops/1.0.1-SNAPSHOT/devops-1.0.1-20181013.182353-40.war"')
		bat('"curl -u admin:redhat@123 -T *.war "http://localhost:8090/manager/text/deploy?path=/devops&update=true""')
      }
   }
   
//}
